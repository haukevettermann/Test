sap.ui.controller("zhr06_kapatool.tree", {                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
	/**                                                                                                                                                                                                                                                           
	 * Called when a controller is instantiated and its View controls (if                                                                                                                                                                                         
	 * available) are already created. Can be used to modify the View before it                                                                                                                                                                                   
	 * is displayed, to bind event handlers and do other one-time                                                                                                                                                                                                 
	 * initialization.                                                                                                                                                                                                                                            
	 *&nbsp;                                                                                                                                                                                                                                                      
	 * @memberOf zhr06_kapatool.tree                                                                                                                                                                                                                              
	 */                                                                                                                                                                                                                                                           
	// onInit: function() {                                                                                                                                                                                                                                       
	//                                                                                                                                                                                                                                                            
	// },                                                                                                                                                                                                                                                         
	/**                                                                                                                                                                                                                                                           
	 * Similar to onAfterRendering, but this hook is invoked before the                                                                                                                                                                                           
	 * controller's View is re-rendered (NOT before the first rendering!                                                                                                                                                                                          
	 * onInit() is used for that one!).                                                                                                                                                                                                                           
	 *&nbsp;                                                                                                                                                                                                                                                      
	 * @memberOf zhr06_kapatool.tree                                                                                                                                                                                                                              
	 */                                                                                                                                                                                                                                                           
	// onBeforeRendering: function() {                                                                                                                                                                                                                            
	//                                                                                                                                                                                                                                                            
	// },                                                                                                                                                                                                                                                         
	/**                                                                                                                                                                                                                                                           
	 * Called when the View has been rendered (so its HTML is part of the                                                                                                                                                                                         
	 * document). Post-rendering manipulations of the HTML could be done here.                                                                                                                                                                                    
	 * This hook is the same one that SAPUI5 controls get after being rendered.                                                                                                                                                                                   
	 *&nbsp;                                                                                                                                                                                                                                                      
	 * @memberOf zhr06_kapatool.tree                                                                                                                                                                                                                              
	 */                                                                                                                                                                                                                                                           
	// onAfterRendering: function() {                                                                                                                                                                                                                             
	//                                                                                                                                                                                                                                                            
	// },                                                                                                                                                                                                                                                         
	/**                                                                                                                                                                                                                                                           
	 * Called when the Controller is destroyed. Use this one to free resources                                                                                                                                                                                    
	 * and finalize activities.                                                                                                                                                                                                                                   
	 *&nbsp;                                                                                                                                                                                                                                                      
	 * @memberOf zhr06_kapatool.tree                                                                                                                                                                                                                              
	 */                                                                                                                                                                                                                                                           
	// onExit: function() {                                                                                                                                                                                                                                       
	//                                                                                                                                                                                                                                                            
	// },                                                                                                                                                                                                                                                         
	getTreeTable : function(gBegda, gEndda, gEditable) {                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		var pressEmplListHandler = function(oEvent) {                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			var row = this.getBindingContext().getProperty('ForecastID');                                                                                                                                                                                               
			var rowTitle = this.getBindingContext().getProperty('Title');                                                                                                                                                                                               
			var rowLongtext = this.getBindingContext().getProperty('KpiLongtext');                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			var string = this.sId;                                                                                                                                                                                                                                      
			var n = string.indexOf("col");                                                                                                                                                                                                                              
			var nInt = n + 3;                                                                                                                                                                                                                                           
			var colTemp = this.sId.substr(nInt, 2);                                                                                                                                                                                                                     
			var col = colTemp.replace("-", "");                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			// console.log("substr ab: " + nInt);                                                                                                                                                                                                                       
			// console.log("colTemp");                                                                                                                                                                                                                                  
			// console.log(colTemp);                                                                                                                                                                                                                                    
			// console.log("col");                                                                                                                                                                                                                                      
			// console.log(col);                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			var dataTable = sap.ui.getCore().byId("dataTable");                                                                                                                                                                                                         
			var colNumeric = parseInt(col);                                                                                                                                                                                                                             
			var colAccess = 0;                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			// console.log("Kpi Longtext: ");                                                                                                                                                                                                                           
			// console.log(rowLongtext);                                                                                                                                                                                                                                
			// console.log("binding context");                                                                                                                                                                                                                          
			// console.log(this.getBindingContext());                                                                                                                                                                                                                   
			// console.log("sId");                                                                                                                                                                                                                                      
			// console.log(this.sId);                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			colNumeric = colNumeric - 2;                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			if (colNumeric > 9) {                                                                                                                                                                                                                                       
				colAccess = 'Mon' + colNumeric;                                                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
			else {                                                                                                                                                                                                                                                      
				colAccess = 'Mon0' + colNumeric;                                                                                                                                                                                                                           
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// console.log("ColAcess");                                                                                                                                                                                                                                 
			// console.log(colAccess);                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			if (colNumeric > 0) {                                                                                                                                                                                                                                       
				col = colNumeric;                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			console.log("dataTableTree");                                                                                                                                                                                                                               
			console.log(dataTable);                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			var dataTableJSON = dataTable.getModel().getProperty("/root");                                                                                                                                                                                              
			var colTitle = dataTableJSON[0][colAccess];                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			// store local input (month, row_id, row_title)                                                                                                                                                                                                             
			var gClickedRowId = row;                                                                                                                                                                                                                                    
			var gClickedRowTitle = rowTitle;                                                                                                                                                                                                                            
			var gClickedMonthYear = colTitle;                                                                                                                                                                                                                           
			var gClickedRowLongtext = rowLongtext;                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			console.log("Clicked: " + gClickedRowId + " / " + gClickedRowTitle + " / " + gClickedMonthYear + " / " + gClickedRowLongtext);                                                                                                                              
                                                                                                                                                                                                                                                               
			// make them globally available                                                                                                                                                                                                                             
			window.gClickedRowId = gClickedRowId;                                                                                                                                                                                                                       
			window.gClickedRowTitle = gClickedRowTitle;                                                                                                                                                                                                                 
			window.gClickedMonthYear = gClickedMonthYear;                                                                                                                                                                                                               
			window.gClickedRowLongtext = gClickedRowLongtext;                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// navigate to new view                                                                                                                                                                                                                                     
			new sap.ui.view({                                                                                                                                                                                                                                           
				id : "empList",                                                                                                                                                                                                                                            
				viewName : "zhr06_kapatool.employee",                                                                                                                                                                                                                      
				type : sap.ui.core.mvc.ViewType.JS                                                                                                                                                                                                                         
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		};                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		var oTreeTable = new sap.ui.table.TreeTable("dataTable", {                                                                                                                                                                                                   
			// width : "100%",                                                                                                                                                                                                                                          
			selectionMode : sap.ui.table.SelectionMode.None,                                                                                                                                                                                                            
			visibleRowCount : 20,                                                                                                                                                                                                                                       
			fixedRowCount : 1,                                                                                                                                                                                                                                          
			fixedColumnCount : 3,                                                                                                                                                                                                                                       
			allowColumnReordering : false,                                                                                                                                                                                                                              
			showColumnVisibilityMenu : false,                                                                                                                                                                                                                           
			// enableColumnFreeze : false,                                                                                                                                                                                                                              
			enableColumnFreeze : true,                                                                                                                                                                                                                                  
			enableCellFilter : false,                                                                                                                                                                                                                                   
			selectionMode : sap.ui.table.SelectionMode.None,                                                                                                                                                                                                            
			enableColumnReordering : false,                                                                                                                                                                                                                             
			expandFirstLevel : false,                                                                                                                                                                                                                                   
			extension : [],                                                                                                                                                                                                                                             
		});                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Tree Table Column Definitions                                                                                                                                                                                                                             
		 */                                                                                                                                                                                                                                                          
		oTreeTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                               
			label : new sap.ui.commons.Label({                                                                                                                                                                                                                          
				text : "Forecast ID",                                                                                                                                                                                                                                      
				textAlign : sap.ui.core.TextAlign.Center                                                                                                                                                                                                                   
			}),                                                                                                                                                                                                                                                         
			template : new sap.ui.commons.TextView({                                                                                                                                                                                                                    
				text : "{ForecastID}",                                                                                                                                                                                                                                     
				textAlign : sap.ui.core.TextAlign.Center                                                                                                                                                                                                                   
			}),                                                                                                                                                                                                                                                         
			visible : false,                                                                                                                                                                                                                                            
		}));                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		oTreeTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                               
			template : new sap.ui.commons.TextView({                                                                                                                                                                                                                    
				text : "{Title}",                                                                                                                                                                                                                                          
				wrapping : true,                                                                                                                                                                                                                                           
				textAlign : sap.ui.core.TextAlign.Begin,                                                                                                                                                                                                                   
				tooltip : "{Tooltip}",                                                                                                                                                                                                                                     
				design : "{Class}",                                                                                                                                                                                                                                        
				semanticColor : "{FontClass}",                                                                                                                                                                                                                             
			// width: '350px',                                                                                                                                                                                                                                          
			}),                                                                                                                                                                                                                                                         
			enableColumnFreeze : true,                                                                                                                                                                                                                                  
			width : '350px',                                                                                                                                                                                                                                            
		// resizable : false,                                                                                                                                                                                                                                        
		// flexible : false,                                                                                                                                                                                                                                         
		}));                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		oTreeTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                               
			template : new sap.ui.commons.TextView({                                                                                                                                                                                                                    
				text : "{KpiLongtext}",                                                                                                                                                                                                                                    
				textAlign : sap.ui.core.TextAlign.Begin,                                                                                                                                                                                                                   
			}),                                                                                                                                                                                                                                                         
			visible : false,                                                                                                                                                                                                                                            
		}));                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * always non-edit-mode, because only in EMP-Add-Handler the table could                                                                                                                                                                                     
		 * be actualized                                                                                                                                                                                                                                             
		 */                                                                                                                                                                                                                                                          
		var layoutID2 = "isLinkOrText99"; // needed in matrix                                                                                                                                                                                                        
		if (gEditable == 'X') {                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			var oText = new sap.ui.commons.TextView({                                                                                                                                                                                                                   
				text : "{Mon01}",                                                                                                                                                                                                                                          
				visible : "{IsText}",                                                                                                                                                                                                                                      
				design : "{Class}",                                                                                                                                                                                                                                        
				semanticColor : "{FontClass}",                                                                                                                                                                                                                             
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			var oLink = new sap.ui.commons.Link({                                                                                                                                                                                                                       
				text : "{Mon01}",                                                                                                                                                                                                                                          
				press : pressEmplListHandler,                                                                                                                                                                                                                              
				visible : "{IsLink}",                                                                                                                                                                                                                                      
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			var oLayout = new sap.ui.layout.HorizontalLayout(layoutID2, {                                                                                                                                                                                               
				content : [                                                                                                                                                                                                                                                
					oText, oLink                                                                                                                                                                                                                                              
				]                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			oTreeTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                              
				label : new sap.ui.commons.Label({                                                                                                                                                                                                                         
					text : oBundle.getText("TreeTableColumnReport"),                                                                                                                                                                                                          
					textAlign : sap.ui.core.TextAlign.Center,                                                                                                                                                                                                                 
				}),                                                                                                                                                                                                                                                        
				template : oLayout,                                                                                                                                                                                                                                        
				// width : 'auto',                                                                                                                                                                                                                                         
				// width : '120px',                                                                                                                                                                                                                                        
				hAlign : sap.ui.core.HorizontalAlign.Center,                                                                                                                                                                                                               
			}));                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		}                                                                                                                                                                                                                                                            
		else {                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			var oText = new sap.ui.commons.TextView({                                                                                                                                                                                                                   
				text : "{Mon01}",                                                                                                                                                                                                                                          
				visible : "{IsText}",                                                                                                                                                                                                                                      
				design : "{Class}",                                                                                                                                                                                                                                        
				styleClass : "{Class}",                                                                                                                                                                                                                                    
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			var oLink = new sap.ui.commons.Link({                                                                                                                                                                                                                       
				text : "{Mon01}",                                                                                                                                                                                                                                          
				press : pressEmplListHandler,                                                                                                                                                                                                                              
				visible : "{IsLink}",                                                                                                                                                                                                                                      
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			var oLayout2 = new sap.ui.layout.HorizontalLayout(layoutID2, {                                                                                                                                                                                              
				content : [                                                                                                                                                                                                                                                
					oText, oLink                                                                                                                                                                                                                                              
				]                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			oTreeTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                              
				label : new sap.ui.commons.Label({                                                                                                                                                                                                                         
					text : oBundle.getText("TreeTableColumnReport"),                                                                                                                                                                                                          
					textAlign : sap.ui.core.TextAlign.Center,                                                                                                                                                                                                                 
				}),                                                                                                                                                                                                                                                        
				template : oLayout2,                                                                                                                                                                                                                                       
				// width : 'auto',                                                                                                                                                                                                                                         
				// width : '120px',                                                                                                                                                                                                                                        
				hAlign : sap.ui.core.HorizontalAlign.Center,                                                                                                                                                                                                               
			}));                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		}                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Anzahl Monate berechnen, dyn. Aufbau der Spalten                                                                                                                                                                                                          
		 */                                                                                                                                                                                                                                                          
		var fromYear = gBegda.substring(0, 4);                                                                                                                                                                                                                       
		var fromMonth = gBegda.substring(4, 6);                                                                                                                                                                                                                      
		var fromDay = gBegda.substring(6, 8);                                                                                                                                                                                                                        
		var toYear = gEndda.substring(0, 4);                                                                                                                                                                                                                         
		var toMonth = gEndda.substring(4, 6);                                                                                                                                                                                                                        
		var toDay = gEndda.substring(6, 8);                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		var dateFrom = new Date(fromYear, fromMonth, fromDay);                                                                                                                                                                                                       
		var dateTo = new Date(toYear, toMonth, toDay);                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
		var diff = dateTo - dateFrom;                                                                                                                                                                                                                                
		var msec = diff;                                                                                                                                                                                                                                             
		var months = Math.floor(msec / 1000 / 60 / 60 / 730);                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * dyn. Columns fr Prognosemonate                                                                                                                                                                                                                           
		 */                                                                                                                                                                                                                                                          
		for (var int = 2; int < months + 2; int++) {                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			var month = "";                                                                                                                                                                                                                                             
			var number = int - 1;                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			if (int < 10) {                                                                                                                                                                                                                                             
				month = "{Mon0" + int + "}";                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
			else {                                                                                                                                                                                                                                                      
				month = "{Mon" + int + "}";                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (gEditable == 'X') {                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
				var oText = new sap.ui.commons.TextView({                                                                                                                                                                                                                  
					text : month,                                                                                                                                                                                                                                             
					visible : "{IsText}",                                                                                                                                                                                                                                     
					design : "{Class}",                                                                                                                                                                                                                                       
					semanticColor : "{FontClass}",                                                                                                                                                                                                                            
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				var oLink = new sap.ui.commons.Link({                                                                                                                                                                                                                      
					text : month,                                                                                                                                                                                                                                             
					press : pressEmplListHandler,                                                                                                                                                                                                                             
					visible : "{IsLink}",                                                                                                                                                                                                                                     
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				var layoutID = "isLinkOrText" + int;                                                                                                                                                                                                                       
				var oLayout = new sap.ui.layout.HorizontalLayout(layoutID, {                                                                                                                                                                                               
					content : [                                                                                                                                                                                                                                               
						oText, oLink                                                                                                                                                                                                                                             
					]                                                                                                                                                                                                                                                         
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				oTreeTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                             
					label : new sap.ui.commons.Label({                                                                                                                                                                                                                        
						text : oBundle.getText("TreeTableColumnForecast") + " " + number,                                                                                                                                                                                        
						textAlign : sap.ui.core.TextAlign.Center,                                                                                                                                                                                                                
						hAlign : sap.ui.core.HorizontalAlign.Center,                                                                                                                                                                                                             
					}),                                                                                                                                                                                                                                                       
					template : oLayout,                                                                                                                                                                                                                                       
					// width : '120px',                                                                                                                                                                                                                                       
					// width : 'auto',                                                                                                                                                                                                                                        
					hAlign : sap.ui.core.HorizontalAlign.Center,                                                                                                                                                                                                              
				}));                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
			else {                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
				var oText = new sap.ui.commons.TextView({                                                                                                                                                                                                                  
					text : "{Mon01}",                                                                                                                                                                                                                                         
					visible : "{IsText}",                                                                                                                                                                                                                                     
					design : "{Class}",                                                                                                                                                                                                                                       
					semanticColor : "{FontClass}",                                                                                                                                                                                                                            
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				var oLink = new sap.ui.commons.Link({                                                                                                                                                                                                                      
					text : "{Mon01}",                                                                                                                                                                                                                                         
					press : pressEmplListHandler,                                                                                                                                                                                                                             
					visible : "{IsLink}"                                                                                                                                                                                                                                      
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				var layoutID = "isLinkOrText" + int;                                                                                                                                                                                                                       
				var oLayout2 = new sap.ui.layout.HorizontalLayout(layoutID, {                                                                                                                                                                                              
					content : [                                                                                                                                                                                                                                               
						oText, oLink                                                                                                                                                                                                                                             
					]                                                                                                                                                                                                                                                         
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				oTreeTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                             
					label : new sap.ui.commons.Label({                                                                                                                                                                                                                        
						text : oBundle.getText("TreeTableColumnForecast") + " " + number,                                                                                                                                                                                        
						textAlign : sap.ui.core.TextAlign.Center,                                                                                                                                                                                                                
						hAlign : sap.ui.core.HorizontalAlign.Center,                                                                                                                                                                                                             
					}),                                                                                                                                                                                                                                                       
					template : oLayout2,                                                                                                                                                                                                                                      
					// width : 'auto',                                                                                                                                                                                                                                        
					// width : '120px',                                                                                                                                                                                                                                       
					hAlign : sap.ui.core.HorizontalAlign.Center,                                                                                                                                                                                                              
				}));                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
		}                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		return oTreeTable;                                                                                                                                                                                                                                           
		sap.ui.core.BusyIndicator.hide;                                                                                                                                                                                                                              
	},                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
	fillTreeTable : function(oTreeTable, oParameters) {                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		var sServiceUrl = "";                                                                                                                                                                                                                                        
		var dfd = $.Deferred();                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
		// if (oParameters == null || oParameters.Begda == '') {                                                                                                                                                                                                     
		// // sServiceUrl =                                                                                                                                                                                                                                          
		// // '/sap/opu/odata/sap/ZHR06_KAPATOOL_SRV/ForecastSet?$format=json';                                                                                                                                                                                      
		// sServiceUrl =                                                                                                                                                                                                                                             
		// '/sap/opu/odata/SAP/ZMHP_KAPAZITAETSPLANUNG_SRV/ForecastSet?$format=json';                                                                                                                                                                                
		// }                                                                                                                                                                                                                                                         
		// else {                                                                                                                                                                                                                                                    
		console.log("oParameters in Fill");                                                                                                                                                                                                                          
		console.log(oParameters);                                                                                                                                                                                                                                    
		// sServiceUrl =                                                                                                                                                                                                                                             
		// "/sap/opu/odata/SAP/ZMHP_KAPAZITAETSPLANUNG_SRV/ForecastSet " +                                                                                                                                                                                           
		// "?$filter=SelectionBegda eq '" + oParameters.Begda + "'"                                                                                                                                                                                                  
		// + " and SelectionEndda eq '" + oParameters.Endda + "'" + " and                                                                                                                                                                                            
		// SelectionCumulative eq '" + oParameters.Cumulative + "'"                                                                                                                                                                                                  
		// + " and SelectionBukrs eq '" + oParameters.Bukrs + "'" + " and                                                                                                                                                                                            
		// SelectionOrgeh eq '" + oParameters.Orgeh + "'"                                                                                                                                                                                                            
		// + " and SelectionLocation eq '" + oParameters.Location + "'" + " and                                                                                                                                                                                      
		// SelectionKostl eq '" + oParameters.Kostl + "'&$format=json";                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
		sServiceUrl = "/sap/opu/odata/SAP/ZMHP_KAPAZITAETSPLANUNG_SRV/ForecastSet " + "?$filter=SelectionBegda eq '" + oParameters.Begda + "'"                                                                                                                       
			+ " and SelectionEndda eq '" + oParameters.Endda + "'" + " and SelectionCumulative eq '" + oParameters.Cumulative + "'"                                                                                                                                     
			+ " and SelectionOrgeh eq '" + oParameters.Orgeh + "'" + "&$format=json";                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
		// make available for employee.controller - click-event                                                                                                                                                                                                      
		window.gOrgeh = oParameters.Orgeh;                                                                                                                                                                                                                           
		window.gCumulative = oParameters.Cumulative;                                                                                                                                                                                                                 
		window.gLocation = oParameters.Location;                                                                                                                                                                                                                     
		window.gBukrs = oParameters.Bukrs;                                                                                                                                                                                                                           
		window.gKostl = oParameters.Kostl;                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		// }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		var post = $.ajax({                                                                                                                                                                                                                                          
			url : sServiceUrl,                                                                                                                                                                                                                                          
			type : "GET"                                                                                                                                                                                                                                                
		});                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		post.done(function(data) {                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			if (data.d.results.length == 0) {                                                                                                                                                                                                                           
				dfd.resolve(oTreeTable);                                                                                                                                                                                                                                   
			}                                                                                                                                                                                                                                                           
			else {                                                                                                                                                                                                                                                      
				var flat = {};                                                                                                                                                                                                                                             
				for (var i = 0; i < data.d.results.length; i++) {                                                                                                                                                                                                          
					var key = data.d.results[i].ForecastID;                                                                                                                                                                                                                   
					flat[key] = data.d.results[i];                                                                                                                                                                                                                            
					flat[key].__metadata = "";                                                                                                                                                                                                                                
				}                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				for ( var i in flat) {                                                                                                                                                                                                                                     
					flat[i].children = [];                                                                                                                                                                                                                                    
				}                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				for ( var i in flat) {                                                                                                                                                                                                                                     
					var parentkey = flat[i].ParentId;                                                                                                                                                                                                                         
					if (flat[parentkey]) {                                                                                                                                                                                                                                    
						flat[parentkey].children.push(flat[i]);                                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				var root = [];                                                                                                                                                                                                                                             
				for ( var i in flat) {                                                                                                                                                                                                                                     
					var parentkey = flat[i].ParentId;                                                                                                                                                                                                                         
					if (!flat[parentkey]) {                                                                                                                                                                                                                                   
						root.push(flat[i]);                                                                                                                                                                                                                                      
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				var data = {                                                                                                                                                                                                                                               
					root : root,                                                                                                                                                                                                                                              
				};                                                                                                                                                                                                                                                         
				                                                                                                                                                                                                                                                           
				console.log("after");                                                                                                                                                                                                                                      
				var oTreeModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                                                        
				oTreeModel.setData(data);                                                                                                                                                                                                                                  
				console.log("oTreeModel");                                                                                                                                                                                                                                 
				console.log(oTreeModel);                                                                                                                                                                                                                                   
				oTreeTable.setModel(oTreeModel);                                                                                                                                                                                                                           
				oTreeTable.bindRows({                                                                                                                                                                                                                                      
					path : '/root',                                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				console.log(oTreeTable);                                                                                                                                                                                                                                   
				dfd.resolve(oTreeTable);                                                                                                                                                                                                                                   
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		});                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		post.fail(function() {                                                                                                                                                                                                                                       
			dfd.resolve(oTreeTable);                                                                                                                                                                                                                                    
		});                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		return dfd.promise();                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
	},                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
});                                                                                                                                                                                                                                                            